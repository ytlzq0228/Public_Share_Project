æ›´å¥½çš„é˜…è¯»ä½“éªŒï¼Œè¯·é˜…è¯»åŸæ–‡ï¼š
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘PRTGè·å–HUAWEI FusionServer iBMCä¼ æ„Ÿå™¨çŠ¶æ€](https://ctsdn.blog.csdn.net/article/details/109262952)

æœ¬æ–‡ä»‹ç»å¦‚ä½•ä½¿PRTGè·å–HUAWEI FusionServer iBMCä¼ æ„Ÿå™¨çŠ¶æ€ã€‚ä»¥åŠè¡ç”Ÿå‡ºå¦‚ä½•é€šè¿‡ipmié€šç”¨åè®®ç›‘æ§æ‰€æœ‰æœåŠ¡å™¨çš„å¸¦å¤–ç®¡ç†çŠ¶æ€ã€‚
æœ¬æ–‡ä¸»è¦æ¶‰åŠçš„æŠ€æœ¯ç‚¹ï¼š
>1ã€æœåŠ¡å™¨ipmiå‘½ä»¤è¡ŒåŸºæœ¬æ“ä½œ
>2ã€HUAWEI Fusion Server iBMCæ§åˆ¶å°ç™»å½•
>3ã€PRTG Pythoné«˜çº§è‡ªå®šä¹‰è„šæœ¬ä¼ å‚
>4ã€PRTG Pythoné«˜çº§è‡ªå®šä¹‰è„šæœ¬è¿”å›å€¼æ ¼å¼

PRTGç›‘æ§ç³»ç»Ÿå†…å·²ç»å†…ç½®äº†å¯¹DELLã€HPEã€Cisco UCSç­‰ä¸»æµæœåŠ¡å™¨çš„å¸¦å¤–ç®¡ç†çŠ¶æ€ç›‘æ§ã€‚ç”šè‡³è¿è”æƒ³çš„æœåŠ¡å™¨éƒ½é›†æˆäº†å¸¦å¤–ç›‘æ§åŠŸèƒ½ã€‚
ä½†æ˜¯ï¼Œä½†æ˜¯
å¤®å¤®æˆ‘å¤§åä¸ºçš„æœåŠ¡å™¨ï¼Œç«Ÿç„¶æ²¡æœ‰é¢„åˆ¶çš„ç›‘æ§æ¨¡æ¿ï¼Œè¿™è®©æˆ‘å¤§åä¸ºçš„è„¸é¢ä½•åœ¨ï¼Ÿï¼Ÿ

æ­¤ç›‘æ§æ–¹å¼æ”¯æŒå¯¹iBMCç³»ç»Ÿè·å–åˆ°çš„æ‰€æœ‰ä¼ æ„Ÿå™¨å€¼ã€å‘Šè­¦ä¸Šé™å€¼ã€å‘Šè­¦ä¸‹é™å€¼ã€å‘Šè­¦çŠ¶æ€ç­‰ä¿¡æ¯åŒæ­¥åˆ°PRTGç›‘æ§ã€‚æ¯ä¸ªæœåŠ¡å™¨åªå ç”¨1ä¸ªç›‘æ§ç‚¹æˆæƒï¼Œåœ¨1ä¸ªç›‘æ§ç‚¹å†…å®ç°å¯¹æœ€å¤š50ä¸ªé€šé“çš„ä¼ æ„Ÿå™¨å€¼è¿›è¡Œç›‘æ§ã€‚
**PRTGå±•ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š**
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20201024174206359.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l0bHpxMDIyOA==,size_16,color_FFFFFF,t_70#pic_center)
**åŸå§‹æ•°æ®å¦‚ä¸‹ï¼š**
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20201024174903846.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l0bHpxMDIyOA==,size_16,color_FFFFFF,t_70#pic_center)

æœ¬æ–‡æ¶‰åŠçš„ç¤ºä¾‹Githubåœ°å€
[Public_Share_Project/PRTG è‡ªå®šä¹‰ä¼ æ„Ÿå™¨Customer Senser/HUAWEI iBMCä¼ æ„Ÿå™¨/](https://github.com/ytlzq0228/Public_Share_Project/tree/master/PRTG%20%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BC%A0%E6%84%9F%E5%99%A8Customer%20Senser/HUAWEI%20iBMC%E4%BC%A0%E6%84%9F%E5%99%A8)

# ä¸€ã€å…³äºæœåŠ¡å™¨çš„BMCã€IPMIå’ŒHUAWEI iBMC
## 1ã€BMCå’ŒIPMI
CSDNçš„å¼€å‘ç‹—ä»¬ï¼Œä½ è¯´ä½ ä»¬å¤©å¤©è¯´æœåŠ¡å™¨æœåŠ¡å™¨ï¼Œå¯æ˜¯ä½ ä»¬çŸ¥é“æœåŠ¡å™¨ä¸æ™®é€šPCçš„åŒºåˆ«ä¹ˆï¼Ÿ

è°ˆåˆ°æœåŠ¡å™¨ä¸PCçš„åŒºåˆ«ï¼Œæœ€å¤§çš„è«è¿‡äºæœåŠ¡å™¨çš„**å¸¦å¤–ç®¡ç†ï¼ˆBMCï¼‰**ï¼Œæ‰€è°“å¸¦å¤–ç®¡ç†ï¼Œæ˜¯å¯ä»¥é€šè¿‡ç‹¬ç«‹äºä¸»æ“ä½œç³»ç»Ÿçš„å¸¦å¤–ç®¡ç†ç³»ç»Ÿï¼ˆå†…ç½®äºä¸»æ¿ä¸Šçš„ä¸“ç”¨èŠ¯ç‰‡é‡Œï¼‰ç®¡ç†ã€ç›‘æ§æœåŠ¡å™¨æ•´æœºçš„è¿è¡Œæƒ…å†µã€‚åŒ…æ‹¬å¼€æœºå…³æœºã€é…ç½®RAIDã€ç›‘æ§æœåŠ¡å™¨çŠ¶æ€ã€è¿œç¨‹å®‰è£…æ“ä½œç³»ç»Ÿã€æŒ‚è½½ISOåŠUSBè®¾å¤‡ç­‰ã€‚

è€ŒBMCä¸ä»…è¦ç›‘æ§å’Œç®¡ç†CPUã€å†…å­˜ã€RAIDç­‰è®¾å¤‡ï¼ŒåŒæ—¶åˆè¦ä¸æ“ä½œç³»ç»Ÿé€šä¿¡ã€‚åº•å±‚ç¡¬ä»¶ã€BMCã€OSè¿™ä¸‰è€…ä¹‹é—´å½¢æˆä¸€ä¸ªä¸¤ä¸¤å¯ä»¥äº’è®¿çš„ä¸‰è§’å½¢ï¼Œè¿æ¥è¿™ä¸ªä¸‰è§’å½¢çš„é€šç”¨æ¥å£ï¼Œå°±æ˜¯IPMIã€‚

æœ¬æ–‡ä¸å¯¹BMCå’ŒIPMIå±•å¼€åˆ†æï¼Œå–œæ¬¢çš„è¯å¯ä»¥å‚ç…§å¦ä¸€ä¸ªå¤§å¤§çš„æ–‡ç« : [BMCä»‹ç»](https://blog.csdn.net/weixin_42306122/article/details/95642613)
æœ¬æ–‡ï¼Œä¸»è¦é’ˆå¯¹æ€§çš„è¯´è¯´åä¸ºçš„iBMCç³»ç»Ÿ
## 2ã€HUAWEI iBMCç³»ç»Ÿ
åä¸ºæœåŠ¡å™¨iBMCæ™ºèƒ½ç®¡ç†ç³»ç»Ÿï¼ˆä»¥ä¸‹ç®€ç§°iBMCï¼‰æ˜¯åä¸ºå¼€å‘çš„å…·æœ‰å®Œå…¨è‡ªä¸»çŸ¥è¯†äº§æƒçš„æœåŠ¡å™¨è¿œç¨‹ç®¡ç†ç³»ç»Ÿï¼Œæä¾›äº†ä¸°å¯Œçš„ç®¡ç†åŠŸèƒ½ã€‚

- **ä¸°å¯Œçš„ç®¡ç†æ¥å£**
æä¾›æ ‡å‡†çš„DCMI1.5/IPMI1.5/IPMI2.0æ¥å£ã€å‘½ä»¤è¡Œæ¥å£ã€Redfishæ¥å£ã€è¶…æ–‡æœ¬ä¼ è¾“å®‰å…¨åè®®ï¼ˆHTTPSï¼ŒHypertext Transfer Protocol Secureï¼‰å’Œç®€å•ç½‘ç»œç®¡ç†åè®®ï¼ˆSNMPï¼ŒSimple Network Management Protocolï¼‰ï¼Œæ»¡è¶³å¤šç§æ–¹å¼çš„ç³»ç»Ÿé›†æˆéœ€æ±‚ã€‚

- **æ•…éšœç›‘æ§ä¸è¯Šæ–­**
å¯æå‰å‘ç°å¹¶è§£å†³é—®é¢˜ï¼Œä¿éšœè®¾å¤‡7*24å°æ—¶é«˜å¯é è¿è¡Œã€‚
ç³»ç»Ÿå´©æºƒæ—¶ä¸´ç»ˆæˆªå±ä¸å½•åƒåŠŸèƒ½ï¼Œä½¿å¾—åˆ†æç³»ç»Ÿå´©æºƒåŸå› ä¸å†æ— å¤„ä¸‹æ‰‹ã€‚
å±å¹•å¿«ç…§å’Œå±å¹•å½•åƒï¼Œè®©å®šæ—¶å·¡æ£€ã€æ“ä½œè¿‡ç¨‹è®°å½•åŠå®¡è®¡å˜å¾—ç®€å•è½»æ¾ã€‚
FDMåŠŸèƒ½ï¼Œæ”¯æŒåŸºäºéƒ¨ä»¶çš„ç²¾å‡†æ•…éšœè¯Šæ–­ï¼Œæ–¹ä¾¿éƒ¨ä»¶æ•…éšœå®šä½å’Œæ›´æ¢ã€‚
æ”¯æŒSyslogæŠ¥æ–‡ã€TrapæŠ¥æ–‡ã€ç”µå­é‚®ä»¶ä¸ŠæŠ¥å‘Šè­¦ï¼Œæ–¹ä¾¿ä¸Šå±‚ç½‘ç®¡æ”¶é›†æœåŠ¡å™¨æ•…éšœä¿¡æ¯ã€‚
æ”¯æŒLCDç›´æ¥ä»iBMCè·å–è®¾å¤‡ä¿¡æ¯ã€‚
- **å®‰å…¨ç®¡ç†æ‰‹æ®µ**
é€šè¿‡è½¯ä»¶é•œåƒå¤‡ä»½ï¼Œæé«˜ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼Œå³ä½¿å½“å‰è¿è¡Œçš„è½¯ä»¶å®Œå…¨å´©æºƒï¼Œä¹Ÿå¯ä»¥ä»å¤‡ä»½é•œåƒå¯åŠ¨ã€‚
å¤šæ ·åŒ–çš„ç”¨æˆ·å®‰å…¨æ§åˆ¶æ¥å£ï¼Œä¿è¯ç”¨æˆ·ç™»å½•å®‰å…¨æ€§ã€‚
æ”¯æŒå¤šç§è¯ä¹¦çš„å¯¼å…¥æ›¿æ¢ï¼Œä¿è¯æ•°æ®ä¼ è¾“çš„å®‰å…¨æ€§ã€‚
- **ç³»ç»Ÿç»´æŠ¤æ¥å£**
æ”¯æŒè™šæ‹ŸKVMï¼ˆKeyboard, Video, and Mouseï¼‰å’Œè™šæ‹Ÿåª’ä½“åŠŸèƒ½ï¼Œæä¾›æ–¹ä¾¿çš„è¿œç¨‹ç»´æŠ¤æ‰‹æ®µã€‚
æ”¯æŒRAIDçš„å¸¦å¤–ç›‘æ§å’Œé…ç½®ï¼Œæå‡äº†RAIDé…ç½®æ•ˆç‡å’Œç®¡ç†èƒ½åŠ›ã€‚
é€šè¿‡Smart Provisioningå®ç°äº†å…å…‰ç›˜å®‰è£…æ“ä½œç³»ç»Ÿã€é…ç½®RAIDä»¥åŠå‡çº§ç­‰åŠŸèƒ½ï¼Œä¸ºç”¨æˆ·æä¾›æ›´ä¾¿æ·çš„æ“ä½œæ¥å£ã€‚
- **å¤šæ ·åŒ–çš„ç½‘ç»œåè®®**
æ”¯æŒNTPï¼Œæå‡è®¾å¤‡æ—¶é—´é…ç½®èƒ½åŠ›ï¼Œç”¨äºåŒæ­¥ç½‘ç»œæ—¶é—´ã€‚
æ”¯æŒåŸŸç®¡ç†å’Œç›®å½•æœåŠ¡ï¼Œç®€åŒ–æœåŠ¡å™¨ç®¡ç†ç½‘ç»œã€‚
- **æ™ºèƒ½ç”µæºç®¡ç†**
åŠŸç‡å°é¡¶æŠ€æœ¯åŠ©æ‚¨è½»æ¾æé«˜éƒ¨ç½²å¯†åº¦ï¼›åŠ¨æ€èŠ‚èƒ½æŠ€æœ¯åŠ©æ‚¨æœ‰æ•ˆé™ä½è¿è¥è´¹ç”¨ã€‚

- **è®¸å¯è¯ç®¡ç†**
é€šè¿‡ç®¡ç†è®¸å¯è¯ï¼Œå¯å®ç°ä»¥æˆæƒæ–¹å¼ä½¿ç”¨iBMCé«˜çº§ç‰ˆçš„ç‰¹æ€§ã€‚

- **iBMCé«˜çº§ç‰ˆè¾ƒæ ‡å‡†ç‰ˆæä¾›æ›´å¤šçš„é«˜çº§ç‰¹æ€§ï¼Œä¾‹å¦‚**ï¼š
é€šè¿‡Redfishå®ç°OSéƒ¨ç½²ã€OSå…‹éš†å’ŒOSè¿˜åŸã€‚
é€šè¿‡Redfishæ”¶é›†æ™ºèƒ½è¯Šæ–­çš„åŸå§‹æ•°æ®ã€‚
# äºŒã€HUAWEI iBMCå†…ipmcå‘½ä»¤è¡Œè·å–ä¼ æ„Ÿå™¨ä¿¡æ¯
## 1ã€iBMCå‘½ä»¤è¡Œç®€ä»‹
ipmiæ¥å£æœ‰ä¸€ä¸ªæ ‡å‡†çš„ipmitoolså‘½ä»¤è¡Œï¼Œåä¸ºåœ¨ipmitoolså‘½ä»¤è¡Œçš„åŸºç¡€ä¹‹ä¸Šï¼Œæ”¹è¿›ä½¿ç”¨äº†ipmcå‘½ä»¤è¡Œ
iBMCç®¡ç†è½¯ä»¶å¸¸ç”¨å‘½ä»¤æœ‰ä»¥ä¸‹2ç±»ï¼š

- æŸ¥è¯¢å‘½ä»¤ipmcget
æŸ¥è¯¢å‘½ä»¤ipmcgetçš„æ ¼å¼å¦‚ä¸‹ï¼š
**ipmcget [-t target] -d dataitem [-v value]**

- è®¾ç½®å‘½ä»¤ipmcset
è®¾ç½®å‘½ä»¤ipmcsetçš„æ ¼å¼å¦‚ä¸‹ï¼š
**ipmcset [-t target] -d dataitem [-v value]**

æŸ¥è¯¢å‘½ä»¤ipmcgetå’Œè®¾ç½®å‘½ä»¤ipmcsetçš„å‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š

- [ ]ï¼šè¡¨æ˜è¯¥å†…å®¹ä¸æ˜¯æ¯æ¡å‘½ä»¤éƒ½åŒ…å«çš„éƒ¨åˆ†ã€‚
- -t targetï¼šæŸ¥è¯¢ã€è®¾ç½®æ“ä½œè®¾å¤‡ä¸Šçš„å¯¹è±¡ã€‚
- -d dataitemï¼šæŸ¥è¯¢ã€è®¾ç½®æ“ä½œè®¾å¤‡æˆ–æ“ä½œè®¾å¤‡ä¸Šéƒ¨ä»¶çš„ç‰¹å®šå±æ€§ã€‚
- -v valueï¼šæŸ¥è¯¢ã€è®¾ç½®æ“ä½œè®¾å¤‡ä¸Šéƒ¨ä»¶çš„å‚æ•°å€¼ã€‚

å…·ä½“ä¿¡æ¯ï¼Œå‚è§[FusionServer Pro æœºæ¶æœåŠ¡å™¨ iBMC (V561è‡³V649) ç”¨æˆ·æŒ‡å— 01](https://support.huawei.com/enterprise/zh/doc/EDOC1100140661/6eb29f7e)

## 2ã€ç™»å½•iBMCå‘½ä»¤è¡Œ
æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç™»å½•ç®¡ç†è½¯ä»¶å‘½ä»¤è¡Œï¼š

- SSH
é€šè¿‡SSHæ–¹å¼ç™»å½•å‘½ä»¤è¡Œï¼Œæœ€å¤šå…è®¸5ä¸ªç”¨æˆ·åŒæ—¶ç™»å½•ã€‚
SSHæœåŠ¡æ”¯æŒçš„åŠ å¯†ç®—æ³•æœ‰â€œAES128-CTRâ€ã€â€œAES192-CTRâ€å’Œâ€œAES256-CTRâ€ã€‚ä½¿ç”¨SSHç™»å½•iBMCæ—¶ï¼Œè¯·ä½¿ç”¨æ­£ç¡®çš„åŠ å¯†ç®—æ³•ã€‚

- æœ¬åœ°ä¸²å£
V5æœåŠ¡å™¨æä¾›1ä¸ªiBMCé»˜è®¤ç”¨æˆ·â€œAdministratorâ€ï¼Œé»˜è®¤å¯†ç è¯·å‚è§äº§å“çš„é“­ç‰Œã€‚
è¿ç»­5æ¬¡è¾“å…¥é”™è¯¯çš„å¯†ç åï¼Œç³»ç»Ÿå°†å¯¹æ­¤ç”¨æˆ·è¿›è¡Œé”å®šã€‚ç­‰å¾…5åˆ†é’Ÿåï¼Œæ–¹å¯é‡æ–°ç™»å½•ï¼Œäº¦å¯é€šè¿‡ç®¡ç†å‘˜åœ¨å‘½ä»¤è¡Œä¸‹è§£é”ã€‚
ä¸ºä¿è¯ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼Œåˆæ¬¡ç™»å½•æ—¶ï¼Œè¯·åŠæ—¶ä¿®æ”¹åˆå§‹å¯†ç ï¼Œå¹¶å®šæœŸæ›´æ–°ã€‚
é»˜è®¤æƒ…å†µä¸‹ï¼Œå‘½ä»¤è¡Œè¶…æ—¶æ—¶é—´ä¸º15åˆ†é’Ÿã€‚

**é€šè¿‡SSHç™»å½•**
1. åœ¨å®¢æˆ·ç«¯ä¸‹è½½ç¬¦åˆSSHåè®®çš„é€šè®¯å·¥å…·ã€‚
2. å°†å®¢æˆ·ç«¯è¿æ¥ï¼ˆç›´è¿æˆ–é€šè¿‡ç½‘ç»œè¿æ¥ï¼‰åˆ°æœåŠ¡å™¨ç®¡ç†ç½‘å£ã€‚
3. é…ç½®å®¢æˆ·ç«¯åœ°å€ï¼Œä½¿å…¶å¯ä¸æœåŠ¡å™¨iBMCç®¡ç†ç½‘å£äº’é€šã€‚
4. åœ¨å®¢æˆ·ç«¯æ‰“å¼€SSHå·¥å…·å¹¶é…ç½®ç›¸å…³å‚æ•°ï¼ˆå¦‚IPåœ°å€ï¼‰ã€‚
5. è¿æ¥åˆ°iBMCåï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ã€‚

**é€šè¿‡ä¸²å£ç™»å½•**

1. é€šè¿‡ä¸²å£ç™»å½•iBMCå‘½ä»¤è¡Œï¼Œå¿…é¡»ä¿è¯æœºç®±çš„ç³»ç»Ÿä¸²å£å·²ç»åˆ‡æ¢ä¸ºiBMCä¸²å£ã€‚å¯ä»¥é€šè¿‡SSHç™»å½•å‘½ä»¤è¡Œï¼Œæ‰§è¡ŒæŸ¥è¯¢å’Œè®¾ç½®ä¸²å£æ–¹å‘ï¼ˆserialdirï¼‰åˆ‡æ¢ä¸²å£ï¼Œæˆ–å‚è€ƒæœåŠ¡å™¨äº§å“æ–‡æ¡£ä¸­çš„è·³çº¿åˆ‡æ¢æ–¹å¼åˆ‡æ¢ä¸²å£ã€‚
2. è¿æ¥ä¸²å£çº¿ã€‚
-- é€šè¿‡è¶…çº§ç»ˆç«¯ç™»å½•ä¸²å£å‘½ä»¤è¡Œï¼Œéœ€è¦è®¾ç½®çš„å‚æ•°æœ‰ï¼š
-- æ³¢ç‰¹ç‡ï¼š115200
-- æ•°æ®ä½ï¼š8
-- å¥‡å¶æ ¡éªŒï¼šæ— 
-- åœæ­¢ä½ï¼š1
-- æ•°æ®æµæ§åˆ¶ï¼šæ— 
3. å‘¼å«æˆåŠŸåè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ã€‚

è¯¦ç»†æ‰‹å†Œï¼Œå‚è€ƒ[ã€åä¸ºiBMCç™»å½•å‘½ä»¤è¡Œã€‘](https://support.huawei.com/enterprise/zh/doc/EDOC1100140661/b704022b)
## 3ã€é€šè¿‡iBMCå‘½ä»¤è¡Œè·å–ä¼ æ„Ÿå™¨å€¼åˆ—è¡¨
æŸ¥è¯¢æ‰€æœ‰ä¼ æ„Ÿå™¨çš„æ‰€æœ‰ä¿¡æ¯ï¼ˆsensor -d listï¼‰
**å‘½ä»¤åŠŸèƒ½**
sensor -d listå‘½ä»¤ç”¨æ¥æŸ¥è¯¢æ‰€æœ‰ä¼ æ„Ÿå™¨ä¿¡æ¯ã€‚

**å‘½ä»¤æ ¼å¼**
ipmcget -t sensor -d list

```powershell
iBMC:/->ipmcget -t sensor -d list
sensor id  | sensor name      | value      | unit         | status | lnr        | lc         | lnc        | unc      | uc         | unr        | phys   | nhys
0x1        | Inlet Temp       | 25.000     | degrees C    | ok     | na         | na         | na         | 46.000   | 48.000     | na         | 2.000  | 2.000
0x2        | Outlet Temp      | 35.000     | degrees C    | ok     | na         | na         | na         | 75.000   | na         | na         | 2.000  | 2.000
0x3        | PCH Temp         | 46.000     | degrees C    | ok     | na         | na         | na         | 86.000   | na         | na         | 2.000  | 2.000
0x4        | CPU1 Core Rem    | 47.000     | degrees C    | ok     | na         | na         | na         | na       | na         | na         | 2.000  | 2.000
.............................
```
**å­—æ®µå«ä¹‰**
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20201024180856535.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l0bHpxMDIyOA==,size_16,color_FFFFFF,t_70#pic_center)
è¿™æ ·ï¼Œæˆ‘ä»¬è·å–äº†ä¼ æ„Ÿå™¨å€¼çš„åŸå§‹æ•°æ®ï¼Œæ¥ä¸‹æ¥éœ€è¦é€šè¿‡pythonè¿›è¡Œæ•´ç†ï¼ŒæŒ‰ç…§PRTGçš„æ ‡å‡†æ ¼å¼è¿›è¡Œè¾“å‡ºã€‚

# ä¸‰ã€PRTG Pythoné«˜çº§è‡ªå®šä¹‰è„šæœ¬åº”ç”¨
## 1ã€Pythonè„šæœ¬æ–‡ä»¶
[Public_Share_Project/PRTG è‡ªå®šä¹‰ä¼ æ„Ÿå™¨Customer Senser/HUAWEI iBMCä¼ æ„Ÿå™¨/](https://github.com/ytlzq0228/Public_Share_Project/tree/master/PRTG%20%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BC%A0%E6%84%9F%E5%99%A8Customer%20Senser/HUAWEI%20iBMC%E4%BC%A0%E6%84%9F%E5%99%A8)
**1ã€ä¸‹è½½æ­¤Pythonè„šæœ¬æ–‡ä»¶**
**2ã€ä¿®æ”¹ç™»å½•ä¿¡æ¯**
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20201024181511151.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l0bHpxMDIyOA==,size_16,color_FFFFFF,t_70#pic_left)
3ã€ä¿®æ”¹æ„Ÿå…´è¶£ä¼ æ„Ÿå™¨åˆ—è¡¨
`interest_sensor_name_list`å†…çš„ä¼ æ„Ÿå™¨åç§°æ‰ä¼šè¿›å…¥åç»­çš„çŠ¶æ€è®¡ç®—å’Œå±•ç¤ºï¼Œç”±äºPRTGé™åˆ¶ä¸€ä¸ªä¼ æ„Ÿå™¨æœ€å¤š50ä¸ªé€šé“ï¼Œæ­¤åˆ—è¡¨é•¿åº¦æ§åˆ¶åœ¨49ä»¥å†…ã€‚
æ„Ÿå…´è¶£ä¼ æ„Ÿå™¨åç§°ä¸é€šè¿‡`ipmcget -t sensor -d list`å‘½ä»¤è·å–çš„`sensor name`å­—æ®µéœ€ä¿æŒä¸€è‡´
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20201024181540718.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l0bHpxMDIyOA==,size_16,color_FFFFFF,t_70#pic_left)
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20201024181749878.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l0bHpxMDIyOA==,size_16,color_FFFFFF,t_70#pic_center)
## 2ã€PRTGæ·»åŠ Pythonè„šæœ¬
### 1ï¼‰ä¸Šä¼ è„šæœ¬
pythonè„šæœ¬æ”¹å¥½åï¼Œä¼ åˆ°PRTG`ç›‘æ§æ¢é’ˆ`çš„å¦‚ä¸‹ç›®å½•ã€‚æ³¨æ„å¦‚æœæ˜¯åˆ†å¸ƒå¼æ¢é’ˆæ¨¡å¼ï¼Œéœ€è¦ä¼ åˆ°æ¢é’ˆä¸Šï¼Œè€Œä¸æ˜¯æ ¸å¿ƒæœåŠ¡å™¨ã€‚

```powershell
Program Files (x86)\PRTG Network Monitor\Custom Sensors\python
```
### 2ï¼‰ PRTGå†…ç½®Pythonå®‰è£…paramiko

```powershell
"C:\Program Files (x86)\PRTG Network Monitor\python\python.exe" -m pip install paramiko
```
### 3ï¼‰PRTGæ·»åŠ æœåŠ¡å™¨è®¾å¤‡
æ·»åŠ è®¾å¤‡ï¼ŒIPåœ°å€æˆ–DNSåŸŸåå¡«å…¥æœåŠ¡å™¨iBMCåœ°å€
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20201024183044353.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l0bHpxMDIyOA==,size_16,color_FFFFFF,t_70#pic_left)
### 4ï¼‰PRTGæ·»åŠ Pythonè„šæœ¬
åœ¨æ·»åŠ å¥½çš„è®¾å¤‡é‡Œï¼Œæ·»åŠ ä¼ æ„Ÿå™¨ã€‚ä¼ æ„Ÿå™¨ç±»å‹é€‰æ‹©**Pythonè„šæœ¬é«˜çº§ï¼ˆPYTHON SCRIPT ADVANCED SENSORï¼‰**
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20201024183223440.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l0bHpxMDIyOA==,size_16,color_FFFFFF,t_70#pic_center)

Pythonè„šæœ¬é€‰æ‹©åˆšæ‰ä¸Šä¼ çš„.pyæ–‡ä»¶
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20201024183345540.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l0bHpxMDIyOA==,size_16,color_FFFFFF,t_70#pic_left)
ç„¶åå•å‡»ä¿å­˜ã€‚
ç¨ç­‰ç‰‡åˆ»åï¼Œå³å¯çœ‹åˆ°pythonè„šæœ¬æŠ“å–çš„ä¼ æ„Ÿå™¨ä¿¡æ¯ï¼Œå·²ç»åœ¨PRTGä¸­æˆåŠŸå±•ç¤º
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20201024183527221.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l0bHpxMDIyOA==,size_16,color_FFFFFF,t_70#pic_center)
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20201024183552477.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l0bHpxMDIyOA==,size_16,color_FFFFFF,t_70#pic_center)
è‡³æ­¤ï¼Œæœ¬æ–‡å¼€å¤´è¯´åˆ°çš„åŠŸèƒ½å·²ç»å®Œæˆï¼Œå¯¹äºå…¶ä»–çš„æœåŠ¡å™¨ï¼Œå¤åˆ¶æ­¥éª¤1-4ï¼Œå³å¯æ·»åŠ æ›´å¤šçš„æœåŠ¡å™¨ã€‚
æ¥ä¸‹æ¥ï¼Œæ˜¯ä¸€äº›æ‹“å±•çŸ¥è¯†ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦ç»§ç»­é˜…è¯»ã€‚
# å››ã€PRTG Pythonè„šæœ¬ä¼ å‚æ ¼å¼

æ­¤å‰ï¼Œåšä¸»å·²ç»å†™è¿‡å¥½å¤šå¥½å¤šå…³äºPRTGè‡ªå®šä¹‰è„šæœ¬çš„xmlè¿”å›å€¼æ ¼å¼ï¼Œä»Šå¤©æˆ‘ä»¬ä¸è¯´è¿”å›å€¼äº†ï¼Œè¯´è¯´è°ƒç”¨å‚æ•°ã€‚

å…³äºè¿”å›å€¼æ ¼å¼ï¼Œå¯ä»¥å‚è€ƒä¹‹å‰çš„æ–‡ç« [ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘PRTGç›‘æ§ç³»ç»Ÿé…åˆæ ‘è“æ´¾é‡‡é›†ä¼ä¸šå†…éƒ¨æ— çº¿ç½‘ç»œè´¨é‡](https://blog.csdn.net/ytlzq0228/article/details/104739756)

å‰é¢çš„ä¾‹å­ä¸­ï¼Œç»†å¿ƒçš„åŒå­¦ä¼šå‘ç°ã€‚Pythonè„šæœ¬ä¸­å¹¶æ²¡æœ‰å†™æœåŠ¡å™¨çš„IPåœ°å€ï¼ŒPRTGåœ¨æ·»åŠ Pythonè„šæœ¬çš„æ—¶å€™ï¼Œä¹Ÿæ²¡æœ‰å†™ä¼ é€’è®¾å¤‡IPåœ°å€çš„å‚æ•°ã€‚
é‚£ä¹ˆPRTGåœ¨è°ƒç”¨Pythonè„šæœ¬çš„æ—¶å€™ï¼Œæ˜¯å¦‚ä½•ä¼ é€’è®¾å¤‡IPåœ°å€çš„å‘¢ï¼Ÿ

æˆ‘ä»¬åœ¨PRTGå®˜æ–¹çš„æ‰‹å†Œé‡Œï¼Œå¯¹äºPythonè„šæœ¬çš„ä¼ é€’å‚æ•°å¹¶æ²¡æœ‰æ‰¾åˆ°è¯¦ç»†çš„è§£é‡Šã€‚åªæœ‰å¦‚ä¸‹ä¸€å¥
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20201024183920689.png#pic_left)
è¡¨ç¤ºä»¥ä¸‹å­—æ®µè¾“å…¥çš„å€¼ã€‚è¿™......è²Œä¼¼æ¯›ç”¨éƒ½æ²¡æœ‰å•Š
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/2020102418395991.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l0bHpxMDIyOA==,size_16,color_FFFFFF,t_70#pic_center)
å…³äºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åœ¨PRTGçš„KBé‡Œæ‰¾åˆ°äº†ä¸€ä¸ªæ¯”è¾ƒé è°±çš„è§£é‡Šã€‚
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/2020102418414678.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l0bHpxMDIyOA==,size_16,color_FFFFFF,t_70#pic_left)
ğŸ¤”ï¼Œéš¾é“è¯´ï¼ŒPRTGé»˜è®¤å°±ä¼šå¯¹æ‰€æœ‰æ‰§è¡Œçš„Pythonè„šæœ¬ä¼ é€’ä¸€ä¸ªJSONæ ¼å¼çš„å‚æ•°ï¼Ÿ
äºæ˜¯ï¼Œæˆ‘ä»¬éšä¾¿å†™äº†ä¸€ä¸ªsave_logçš„è„šæœ¬ï¼Œåˆ›å»ºä½¿ç”¨è¿™ä¸ªè„šæœ¬çš„ä¼ æ„Ÿå™¨ï¼Œè¿è¡Œä¸€ä¸‹ï¼Œçœ‹çœ‹PRTGåˆ°åº•ä¼ é€’æ˜¯ä»€ä¹ˆæ ·å­çš„å‚æ•°ã€‚

```python
import os
import sys
from datetime import datetime


SITE_DIR = os.path.dirname(os.path.abspath(__file__))

result=sys.argv[1]

now = datetime.now().strftime('%d-%m-%Y %H:%M:%S')

f = open(SITE_DIR+"\run_log.txt",'a')
f.writelines("\n%s:log:%s" %(now,result))
f.flush()
f.close()
```
ç»“æœï¼Œæˆ‘ä»¬æŠ“åˆ°äº†PRTGé»˜è®¤ä¼ é€’çš„å‚æ•°æ˜¯è¿™æ ·å­çš„ã€‚å³ä½¿åœ¨åˆ›å»ºä¼ æ„Ÿå™¨çš„æ—¶å€™ä¸å¡«å†™ä»»ä½•é™„åŠ å‚æ•°ï¼ŒPRTGä¾ç„¶ä¼šä¼ é€’ä»¥ä¸‹ä¸°å¯Œçš„å‚æ•°ç»™åˆ°Pythonè„šæœ¬ã€‚

```json
{"momopersistent":"",
"fastcount":"0",
"lastuptime":"0",
"hostv6":"",
"writeresult":"0",
"blockedsens":"",
"reqmsginterval":"60",
"tlsexplicit_default":"",
"tlsexplicit_imap":"",
"uptimecount":"0",
"canlinux":"0",
"isexesensor":"0",
"mutexname":"",
"reboot":"44127.3734878588",
"usednstime":"0",
"pythonscript":"save_log.py",
"tlsexplicit_port":"",
"inerror":"1",
"sensorid":"4935",
"ipversion":"0",
"tlsexplicit_smtp":"",
"params":"",
"host":"172.16.0.22",
"usewindowsauthentication":"0",
"simulate":"0",
"timeout":"59",
"tlsexplicit_ftp":"",
"lastmsg":"#O2",
"notonpod":"0",
"tlsexplicit_pop3":""}
```
è¿™é‡Œé¢ï¼Œæˆ‘ä»¬çœ‹åˆ°è®¾å¤‡IPåœ°å€å†™åœ¨äº†hostå­—æ®µé‡Œã€‚åŒæ—¶è¿˜ä¼ é€’äº†å…¶ä»–å„ç§ä¸°å¯Œçš„å­—æ®µï¼Œè¿™è®©Pythonè„šæœ¬çš„ç¼–å†™ä¼šæ›´åŠ çµæ´»ã€‚
å› æ­¤ï¼Œé’ˆå¯¹æœ¬æ–‡çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹ç®€å•çš„ä»£ç æ¥æå–hostå­—æ®µä½œä¸ºdeviceipï¼Œç”¨äºåç»­sshè¿æ¥ä½¿ç”¨ã€‚

```powershell
data = json.loads(sys.argv[1])
deviceip = data['host']
```
å¥½å•¦ï¼Œè¿™æ¬¡å°±è¯´åˆ°è¿™é‡Œã€‚å¸Œæœ›èƒ½å¸®åˆ°å¤§å®¶

å¾€æœŸå›é¡¾ï¼š
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘PRTGè‡ªå®šä¹‰è„šæœ¬sshç™»å½•ç½‘ç»œè®¾å¤‡è·è´Ÿè½½å‡è¡¡é“¾è·¯çŠ¶æ€](https://ctsdn.blog.csdn.net/article/details/108779892)
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘Django+IIS+Pythonæ„å»ºå¾®è½¯ADåŸŸæ§APIç®¡ç†ä¸­å¿ƒ](https://ctsdn.blog.csdn.net/article/details/107361857)
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘é€šè¿‡ä¼ä¸šå¾®ä¿¡æ¨é€ADåŸŸå¯†ç å³å°†åˆ°æœŸæé†’](https://ctsdn.blog.csdn.net/article/details/107073601)
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘ADåŸŸæ§ Dsquery æŸ¥è¯¢å‘½ä»¤å®ä¾‹æ±‡æ€»](https://ctsdn.blog.csdn.net/article/details/107074237)
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘Google AdminæœåŠ¡è´¦å·+APIç®¡ç†G suitå†…æ‰€æœ‰ç½‘åŸŸç”¨æˆ·](https://blog.csdn.net/ytlzq0228/article/details/105682567)
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘PRTGç›‘æ§ç³»ç»Ÿé€šè¿‡ä¼ä¸šå¾®ä¿¡æ¨é€å›¾æ–‡æ··æ’å‘Šè­¦æ¶ˆæ¯](https://blog.csdn.net/ytlzq0228/article/details/105525667)
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘PRTG HTTP APIè·å–æŒ‡å®šä¼ æ„Ÿå™¨æµé‡å›¾è¡¨å›¾ç‰‡](https://blog.csdn.net/ytlzq0228/article/details/105524615)
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘PRTGç›‘æ§ç³»ç»Ÿåˆå¹¶å¤šä¸ªä¼ æ„Ÿå™¨é€šé“æ•°æ®](https://blog.csdn.net/ytlzq0228/article/details/104736297)
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘PRTGç›‘æ§ç³»ç»Ÿé€šè¿‡ä¼ä¸šå¾®ä¿¡æ¨é€å‘Šè­¦æ¶ˆæ¯](https://blog.csdn.net/ytlzq0228/article/details/104733958)
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘PRTGç›‘æ§ç³»ç»Ÿé…åˆæ ‘è“æ´¾é‡‡é›†ä¼ä¸šå†…éƒ¨æ— çº¿ç½‘ç»œè´¨é‡](https://blog.csdn.net/ytlzq0228/article/details/104739756)
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘vMware ESXi 6.7åˆå¹¶ç¬¬ä¸‰æ–¹ç¡¬ä»¶é©±åŠ¨](https://blog.csdn.net/ytlzq0228/article/details/105194719)
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘Kiwi Syslog Serverå®‰è£…å’Œé…ç½®æ•™ç¨‹](https://blog.csdn.net/ytlzq0228/article/details/104827014)
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘Kiwi Syslog Web Accessä¸Active Directoryé›†æˆè®¤è¯](https://blog.csdn.net/ytlzq0228/article/details/104826989)
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘vMware ESXi 6.7åˆå¹¶ç¬¬ä¸‰æ–¹ç¡¬ä»¶é©±åŠ¨](https://blog.csdn.net/ytlzq0228/article/details/105194719)
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘Windows Server Network Policy Serviceï¼ˆNPSï¼‰è®°è´¦ä¸å®¡è®¡](https://blog.csdn.net/ytlzq0228/article/details/104760054)
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘Windows Server NPSæœåŠ¡æ„å»ºåŸºäºADåŸŸæ§çš„radiusè®¤è¯](https://blog.csdn.net/ytlzq0228/article/details/104758242)
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘ADåŸŸæ§å’Œfreeradiusé›†æˆè®¤è¯ç¯å¢ƒï¼ŒPAPï¼ŒMSCHAPV2](https://blog.csdn.net/ytlzq0228/article/details/104757395)
[ã€é€—è€å¸ˆå¸¦ä½ å­¦ITã€‘æ·±ä¿¡æœSSLè¿œç¨‹æ¥å…¥ä¸æ·±ä¿¡æœè¡Œä¸ºå®¡è®¡åŒæ­¥ç™»é™†ç”¨æˆ·ä¿¡æ¯](https://blog.csdn.net/ytlzq0228/article/details/104723838)
